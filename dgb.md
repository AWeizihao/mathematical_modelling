# 第一题
## 第一问
代码：
```py
import pandas as pd
import numpy as np

df1=pd.read_excel(io=r'./1.xlsx')
df2=pd.read_excel(io=r'./附件2：各园区典型日风光发电数据.xlsx',header=1)

load=[0,0,0]
load[0] = df1.iloc[0:, 1].tolist() #园区A的负荷（kW），对应时间是00：00-23：00
load[1] = df1.iloc[0:, 2].tolist() #园区B的负荷（kW）
load[2] = df1.iloc[0:, 3].tolist() #园区c的负荷（kW）

Pm_pv=[750,0,600] #三个园区的光伏装机量
Pm_w=[0,1000,500] #三个园区的风装机量

pu_pv=[df2.iloc[:, 1].tolist(),[0]*24,df2.iloc[:, 3].tolist()] #pu_pv代表三个园区的光伏出力系数
pu_w=[[0]*24,df2.iloc[:, 2].tolist(),df2.iloc[:, 4].tolist()] #pu_w代表园区的风电出力系数


waste_all=0
cc=0
generate=[[],[],[]]
waste=[[],[],[]]
for i in range(3):
    cost=0
    for t in range(24):
        generate[i].append([Pm_pv[i]*pu_pv[i][t],Pm_w[i]*pu_w[i][t]])
        waste[i].append(sum(generate[i][t])-load[i][t])
        if waste[i][t]>0:
            waste_all+=waste[i][t]
            if generate[i][t][0]>load[i][t]: #如果光伏发电能cover需求，全部买光电
                cost+=load[i][t]*0.4
    
            else:
                cost+=generate[i][t][0]*0.4+(load[i][t]-generate[i][t][0])*0.5
                
            
        else:
            cost+=(-waste[i][t])+generate[i][t][0]*0.4+generate[i][t][1]*0.5 #从电网买电
    print(cost)
    cc+=cost

print(cc)
         
```

所以，A园区成本6084.875元，B园区成本5071.15元，C园区成本4963.311元。总成本16119.336元。弃电方面，光伏弃电1503.640kWh，风电弃电1473.080kWh。

购电明细如下（单位是kW）：

+ 第1个园地:
   + 0时刻，买入275.0电网电,0.0光伏电和0风电
   + 1时刻，买入275.0电网电,0.0光伏电和0风电
   + 2时刻，买入277.0电网电,0.0光伏电和0风电
   + 3时刻，买入310.0电网电,0.0光伏电和0风电
   + 4时刻，买入310.0电网电,0.0光伏电和0风电
   + 5时刻，买入293.0电网电,0.0光伏电和0风电
   + 6时刻，买入293.0电网电,0.0光伏电和0风电
   + 7时刻，买入375.65电网电,4.35光伏电和0风电
   + 8时刻，买入148.05电网电,226.95光伏电和0风电
   + 9时刻，买入281光伏电
   + 10时刻，买入447光伏电
   + 11时刻，买入447光伏电
   + 12时刻，买入447光伏电
   + 13时刻，买入405光伏电
   + 14时刻，买入404光伏电
   + 15时刻，买入84.84999999999997电网电,318.15000000000003光伏电和0风电
   + 16时刻，买入221.575电网电,46.425光伏电和0风电
   + 17时刻，买入313.0电网电,0.0光伏电和0风电
   + 18时刻，买入287.0电网电,0.0光伏电和0风电
   + 19时刻，买入288.0电网电,0.0光伏电和0风电
   + 20时刻，买入284.0电网电,0.0光伏电和0风电
   + 21时刻，买入287.0电网电,0.0光伏电和0风电
   + 22时刻，买入277.0电网电,0.0光伏电和0风电
   + 23时刻，买入275.0电网电,0.0光伏电和0风电
+ 第2个园地:
   + 0时刻，买入10.900000000000006电网电,0光伏电和230.1风电
   + 1时刻，买入0光伏电和253风电
   + 2时刻，买入32.19999999999999电网电,0光伏电和296.8风电
   + 3时刻，买入0光伏电和315风电
   + 4时刻，买入0光伏电和290风电
   + 5时刻，买入0光伏电和270风电
   + 6时刻，买入66.80000000000001电网电,0光伏电和240.2风电
   + 7时刻，买入306.7电网电,0光伏电和47.300000000000004风电
   + 8时刻，买入110.20000000000002电网电,0光伏电和153.79999999999998风电
   + 9时刻，买入208.2电网电,0光伏电和106.80000000000001风电
   + 10时刻，买入261.2电网电,0光伏电和51.8风电
   + 11时刻，买入74.1电网电,0光伏电和216.9风电
   + 12时刻，买入5.399999999999977电网电,0光伏电和354.6风电
   + 13时刻，买入149.6电网电,0光伏电和219.4风电
   + 14时刻，买入278.0电网电,0光伏电和111.0风电
   + 15时刻，买入200.4电网电,0光伏电和218.6风电
   + 16时刻，买入34.099999999999966电网电,0光伏电和377.90000000000003风电
   + 17时刻，买入0光伏电和291风电
   + 18时刻，买入0光伏电和379风电
   + 19时刻，买入0光伏电和303风电
   + 20时刻，买入111.29999999999998电网电,0光伏电和219.70000000000002风电
   + 21时刻，买入127.70000000000002电网电,0光伏电和178.29999999999998风电
   + 22时刻，买入131.5电网电,0光伏电和153.5风电
   + 23时刻，买入324.0电网电,0光伏电和0.0风电
+ 第3个园地:
   + 0时刻，买入228.8电网电,0.0光伏电和73.2风电
   + 1时刻，买入183.25电网电,0.0光伏电和108.75风电
   + 2时刻，买入109.05000000000001电网电,0.0光伏电和197.95风电
   + 3时刻，买入201.45电网电,0.0光伏电和91.55000000000001风电
   + 4时刻，买入35.19999999999999电网电,0.0光伏电和235.8风电
   + 5时刻，买入0.0光伏电和252.0风电
   + 6时刻，买入135.70000000000002电网电,0.0光伏电和147.29999999999998风电
   + 7时刻，买入156.0电网电,6.300000000000001光伏电和60.699999999999996风电
   + 8时刻，买入82.69999999999999电网电,196.8光伏电和12.5风电
   + 9时刻，买入283光伏电
   + 10时刻，买入287光伏电
   + 11时刻，买入362光伏电
   + 12时刻，买入446光伏电
   + 13时刻，买入493.26000000000005光伏电和10.739999999999952风电
   + 14时刻，买入400.02光伏电和54.98000000000002风电
   + 15时刻，买入167.85000000000002电网电,256.5光伏电和81.65风电
   + 16时刻，买入137.79电网电,12.96光伏电和132.25风电
   + 17时刻，买入140.6电网电,0.0光伏电和170.4风电
   + 18时刻，买入258.85电网电,0.0光伏电和159.15风电
   + 19时刻，买入58.04999999999998电网电,0.0光伏电和164.95000000000002风电
   + 20时刻，买入143.85电网电,0.0光伏电和85.15风电
   + 21时刻，买入278.25电网电,0.0光伏电和82.75风电
   + 22时刻，买入207.14999999999998电网电,0.0光伏电和94.85000000000001风电
   + 23时刻，买入174.85电网电,0.0光伏电和116.15风电

